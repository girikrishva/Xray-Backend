<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
    <head>
   <p> <div style="margin-left: 23px;">As On: <input type="text" id="datepickerfrom" class="onchange">
Due Status <%= select_tag("due_status", options_for_select([["All","all"],["Complete","complete"],["Incomplete","incomplete"]])) %>
Completion Status <%= select_tag("completion_status", options_for_select([["All","all"],["Complete","complete"],["Incomplete","incomplete"]])) %>
<a href="#" id= "clikc_search" class="table_tools_button">Search </a>
</div></p>
        <script type="text/javascript" src="https://tympanus.net/Tutorials/FancySlidingForm/sliding.form.js"></script>
    </head>
    <style>
        span.reference{
            position:fixed;
            left:5px;
            top:5px;
            font-size:10px;
            text-shadow:1px 1px 1px #fff;
        }
        span.reference a{
            color:#555;
            text-decoration:none;
			text-transform:uppercase;
        }
        span.reference a:hover{
            color:#000;
            
        }
        h1{
            color:#ccc;
            font-size:36px;
            text-shadow:1px 1px 1px #fff;
            padding:20px;
        }
        select {
   -webkit-appearance: button;
   -webkit-border-radius: 2px;
   -webkit-box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.1);
   -webkit-padding-end: 20px;
   -webkit-padding-start: 2px;
   -webkit-user-select: none;
   background-image: url(http://i62.tinypic.com/15xvbd5.png), -webkit-linear-gradient(#FAFAFA, #F4F4F4 40%, #E5E5E5);
   background-position: 100% center;
   background-repeat: no-repeat;
   border: 1px solid #AAA;
   color: #555;
   font-size: inherit;
   margin: 20px;
   overflow: hidden;
   padding: 5px 10px;
   text-overflow: ellipsis;
   white-space: nowrap;
   width: 130px;
}
.hasDatepicker 
{
    height: 20px;
    border: 3px solid #c2c2c2;
    border-radius: 5px;
}
    </style>
    <body>
        <div>
           
        <div id="content1">
            <div id="wrapper1">
               <div id="navigation" style="display:none;">
                    <ul>
                        <li class="selected">
                            <a href="#">Delivery Milestones</a>
                        </li>
                        <li>
                            <a href="#">Invoicing Milestones</a>
                        </li>
                        <li>
                            <a href="#">Collection Milestones</a>
                        </li>
                        <li>
                            <a href="#">Reconciliation Milestones</a>
                        </li>
                    </ul>
                </div>
                <div id="steps">
                        <fieldset class="step step1">
                        
                        </fieldset>
                        <fieldset class="step step2">
                        
                        </fieldset>
                        <fieldset class="step step3">
                        
                        </fieldset>
                         <fieldset class="step step4">
                        
                        </fieldset>
                </div>
             
            </div>
        </div>
    </body>
</html>
<style type="text/css">
    *{
    margin:0px;
    padding:0px;
}
body{
    color:#444444;
    font-size:13px;
    background: #f2f2f2;
    font-family:"Century Gothic", Helvetica, sans-serif;
}
#content1{
    /*margin:15px auto;*/
    text-align:center;
    width:1400px;
    position:relative;
    height:100%;
}
#wrapper1{
    -moz-box-shadow:0px 0px 3px #aaa;
    -webkit-box-shadow:0px 0px 3px #aaa;
    box-shadow:0px 0px 3px #aaa;
    -moz-border-radius:10px;
    -webkit-border-radius:10px;
    border-radius:10px;
    border:2px solid #fff;
    background-color:#f9f9f9;
    width:1400px;
    overflow:hidden;
}
#steps{
    width:1400px;
    /*height:320px;*/
    overflow:hidden;
}
.step{
    float:left;
    width:1400px;
    /*height:320px;*/
}
#navigation{
    height:45px;
    background-color:#e9e9e9;
    border-top:1px solid #fff;
    -moz-border-radius:0px 0px 10px 10px;
    -webkit-border-bottom-left-radius:10px;
    -webkit-border-bottom-right-radius:10px;
    border-bottom-left-radius:10px;
    border-bottom-right-radius:10px;
}
#navigation ul{
    list-style:none;
    float:left;
    margin-left:22px;
}
#navigation ul li{
    float:left;
    border-right:1px solid #ccc;
    border-left:1px solid #ccc;
    position:relative;
    margin:0px 2px;
}
#navigation ul li a{
    display:block;
    height:45px;
    background-color:#444;
    color:#777;
    outline:none;
    font-weight:bold;
    text-decoration:none;
    line-height:45px;
    padding:0px 20px;
    border-right:1px solid #fff;
    border-left:1px solid #fff;
    background:#f0f0f0;
    background:
        -webkit-gradient(
        linear,
        left bottom,
        left top,
        color-stop(0.09, rgb(240,240,240)),
        color-stop(0.55, rgb(227,227,227)),
        color-stop(0.78, rgb(240,240,240))
        );
    background:
        -moz-linear-gradient(
        center bottom,
        rgb(240,240,240) 9%,
        rgb(227,227,227) 55%,
        rgb(240,240,240) 78%
        )
}
#navigation ul li a:hover,
#navigation ul li.selected a{
    background:#d8d8d8;
    color:#666;
    text-shadow:1px 1px 1px #fff;
}
span.checked{
    background:transparent url(../images/checked.png) no-repeat top left;
    position:absolute;
    top:0px;
    left:1px;
    width:20px;
    height:20px;
}
span.error{
    background:transparent url(../images/error.png) no-repeat top left;
    position:absolute;
    top:0px;
    left:1px;
    width:20px;
    height:20px;
}
#steps form fieldset{
    border:none;
    padding-bottom:20px;
}
#steps form legend{
    text-align:left;
    background-color:#f0f0f0;
    color:#666;
    font-size:24px;
    text-shadow:1px 1px 1px #fff;
    font-weight:bold;
    float:left;
    width:590px;
    padding:5px 0px 5px 10px;
    margin:10px 0px;
    border-bottom:1px solid #fff;
    border-top:1px solid #d9d9d9;
}
#steps form p{
    float:left;
    clear:both;
    margin:5px 0px;
    background-color:#f4f4f4;
    border:1px solid #fff;
    width:400px;
    padding:10px;
    margin-left:100px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    -moz-box-shadow:0px 0px 3px #aaa;
    -webkit-box-shadow:0px 0px 3px #aaa;
    box-shadow:0px 0px 3px #aaa;
}
#steps form p label{
    width:160px;
    float:left;
    text-align:right;
    margin-right:15px;
    line-height:26px;
    color:#666;
    text-shadow:1px 1px 1px #fff;
    font-weight:bold;
}
#steps form input:not([type=radio]),
#steps form textarea,
#steps form select{
    background: #ffffff;
    border: 1px solid #ddd;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    outline: none;
    padding: 5px;
    width: 200px;
    float:left;
}
#steps form input:focus{
    -moz-box-shadow:0px 0px 3px #aaa;
    -webkit-box-shadow:0px 0px 3px #aaa;
    box-shadow:0px 0px 3px #aaa;
    background-color:#FFFEEF;
}
#steps form p.submit{
    background:none;
    border:none;
    -moz-box-shadow:none;
    -webkit-box-shadow:none;
    box-shadow:none;
}
#steps form button {
    border:none;
    outline:none;
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
    border-radius: 10px;
    color: #ffffff;
    display: block;
    cursor:pointer;
    margin: 0px auto;
    clear:both;
    padding: 7px 25px;
    text-shadow: 0 1px 1px #777;
    font-weight:bold;
    font-family:"Century Gothic", Helvetica, sans-serif;
    font-size:22px;
    -moz-box-shadow:0px 0px 3px #aaa;
    -webkit-box-shadow:0px 0px 3px #aaa;
    box-shadow:0px 0px 3px #aaa;
    background:#4797ED;
}
#steps form button:hover {
    background:#d8d8d8;
    color:#666;
    text-shadow:1px 1px 1px #fff;
}
 .table {
      width: 100%;
      max-width: 100%;
      margin-bottom: 20px;
  }
  table {
      background-color: transparent;
  }
  table {
      border-spacing: 0;
      border-collapse: collapse;
  }

  .table-striped>tbody>tr:nth-of-type(odd) {
      background-color: #E2E2E2;
  }
  .table>tbody>tr>td, .table>tbody>tr>th, .table>tfoot>tr>td, .table>tfoot>tr>th, .table>thead>tr>td, .table>thead>tr>th {
      padding: 10px;
      line-height: 1.42857143;
      vertical-align: top;
      border-top: 1px solid #ddd;
  }
  .table .table-row-header {
    background:#636363 !important;
    color:#FFF;
  }
  td, th {
      padding: 0;
  }
  .table th , .table td{
      font-size: 14px;
  }
  .table th {
    font-weight: 700;
  }
</style>
<script type="text/javascript">
$(document).ready(function() {
  $(".pagination_information,.pagination,.download_links,#index_table_resource_utilizations").hide()
  $("#page_title").html("Milestone Report")
})
        $(".pagination_information,.pagination,.download_links,#index_table_resource_utilizations").hide()
   $( "#datepickerfrom" ).datepicker({ dateFormat: 'yy-mm-dd' });
         var fullDate = new Date()
  var twoDigitMonth = ((fullDate.getMonth().length+1) === 1)? (fullDate.getMonth()+1) : '0' + (fullDate.getMonth()+1);
  var currentDate = fullDate.getDate() + "/" + twoDigitMonth + "/" + fullDate.getFullYear();
  // currentDate = "2016-12-01"
  $("#clikc_search").on('click',function(){
  //start 
  responce  = ajax_call("api/delivery_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
      $(".step1").html(html_value)
       $.each($("td.name"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("delivery_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
     pop_up_view(currentDate)
         responce  = ajax_call("api/invoicing_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
    
     $(".step2").html(html_value)
      $.each($(".step2").find("td.name"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("invoicing_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
     pop_up_view(currentDate)
     responce  = ajax_call("api/collection_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
      $(".step3").html(html_value)
      $.each($(".step3").find("td.narrative"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("collection_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
      pop_up_view(currentDate)
        responce  = ajax_call("api/reconciliation_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
      $(".step4").html(html_value)
      $.each($(".step4").find("td.narrative"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("reconciliation_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
      pop_up_view(currentDate)
  })
  $( "#datepickerfrom" ).val(currentDate)
    responce  = ajax_call("api/delivery_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
      $(".step1").html(html_value)
       $.each($("td.name"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("delivery_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
     pop_up_view(currentDate)
         responce  = ajax_call("api/invoicing_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
    
     $(".step2").html(html_value)
      $.each($(".step2").find("td.name"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("invoicing_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
     pop_up_view(currentDate)
     responce  = ajax_call("api/collection_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
      $(".step3").html(html_value)
      $.each($(".step3").find("td.narrative"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("collection_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
      pop_up_view(currentDate)
        responce  = ajax_call("api/reconciliation_milestones?as_on="+currentDate+"&due_status="+$("#due_status").val()+"&completion_status="+$("#completion_status").val()+"&with_details=false")
    var html_value = ""
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
      $(".step4").html(html_value)
      $.each($(".step4").find("td.narrative"), function( index1, value1 ){
     $(this).addClass("text_link")
     $(this).addClass("reconciliation_milestones_name")
     $(this).attr('data-popup-open', 'popup-1');
      })
      pop_up_view(currentDate)
       function pop_up_view(currentDate){
             $('[data-popup-open]').on('click', function(e)  {
        var targeted_popup_class = jQuery(this).attr('data-popup-open');
        $('[data-popup="' + targeted_popup_class + '"]').fadeIn(350);
        $(".dropdown_menu").toggle()
        e.preventDefault();
    });
 
    
    $(".delivery_milestones_name").on('click',function(){
      currentDate = $("#datepickerfrom").val()
        responce  = ajax_call("api/delivery_milestone_details?as_on="+currentDate+"&delivery_milestone_id="+$(this).parent().find('td.id').html())
    var html_value = "<span id='close' style='cursor:pointer' hidden></span>"
     $.each( responce, function( index, value ){
        // $.each( value["invoicing_milestones"], function( index1, value1 ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
            // })
      })
    $(".ajax_content").html(html_value)
    $('[data-popup-close]').on('click', function(e)  {
        var targeted_popup_class = jQuery(this).attr('data-popup-close');
        $('[data-popup="' + targeted_popup_class + '"]').fadeOut(10);
        $(".dropdown_menu").toggle()
        e.preventDefault();
    });
    })
    $(".invoicing_milestones_name").on('click',function(){
      currentDate = $("#datepickerfrom").val()
        responce  = ajax_call("api/invoicing_milestone_details?as_on="+currentDate+"&invoicing_milestone_id="+$(this).parent().find('td.id').html())
    var html_value = "<span id='close' style='cursor:pointer' hidden></span>"
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
    $(".ajax_content").html(html_value)
    $('[data-popup-close]').on('click', function(e)  {
        var targeted_popup_class = jQuery(this).attr('data-popup-close');
        $('[data-popup="' + targeted_popup_class + '"]').fadeOut(10);
        $(".dropdown_menu").toggle()
        e.preventDefault();
    });
    })

      $(".collection_milestones_name").on('click',function(){
        currentDate = $("#datepickerfrom").val()
         responce  = ajax_call("api/collection_milestone_details?as_on="+currentDate+"&invoice_header_id="+$(this).parent().find('td.id').html())
    var html_value = "<span id='close' style='cursor:pointer' hidden></span>"
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
    $(".ajax_content").html(html_value)
    $('[data-popup-close]').on('click', function(e)  {
        var targeted_popup_class = jQuery(this).attr('data-popup-close');
        $('[data-popup="' + targeted_popup_class + '"]').fadeOut(10);
        $(".dropdown_menu").toggle()
        e.preventDefault();
    });
    })

      $(".reconciliation_milestones_name").on('click',function(){
         responce  = ajax_call("api/reconciliation_milestone_details?as_on="+currentDate+"&payment_header_id="+$(this).parent().find('td.id').html())
    var html_value = "<span id='close' style='cursor:pointer' hidden></span>"
     $.each( responce, function( index, value ){
         if (index  ==  0){
                  html_value += convert_ajax_to_htm(value).replace("</table>","")
                }
                else{
                  html_value += return_only_t_data(value)
                }
      })
    $(".ajax_content").html(html_value)
    $('[data-popup-close]').on('click', function(e)  {
        var targeted_popup_class = jQuery(this).attr('data-popup-close');
        $('[data-popup="' + targeted_popup_class + '"]').fadeOut(10);
        $(".dropdown_menu").toggle()
        e.preventDefault();
    });
    })
}   
function return_only_t_data(responce){
             var ajax_content_value = "</tr><tr>"
             $.each(responce, function(key, value) {
                  ajax_content_value +="<td class='"+key.replace(" ", "_")+"'style = 'border: 1px solid #ddd;' >"+value+"</td>" 
                  });
           ajax_content_value +="</tr>"
           return ajax_content_value
          }



          function convert_ajax_to_htm(responce){
   var ajax_content_value = "<table class = 'table table-striped'><tr class= 'table-row-header'>"
           $.each(responce, function(key, value) {
                  ajax_content_value +="<th class='"+key.replace(" ", "_")+" 'style = 'border: 1px solid #ddd;'>"+key.replace(/_/g," ").toUpperCase()+"</th>" 
                  });
           ajax_content_value += "</tr><tr>"
             $.each(responce, function(key, value) {
                  ajax_content_value +="<td class='"+key.replace(" ", "_")+"'style = 'border: 1px solid #ddd;' >"+value+"</td>" 
                  });
           ajax_content_value +="</tr></table>"
           return ajax_content_value
          }


    function ajax_call(url) {
        var responce = ""
     $.ajax({
            async: false,
            url: url,
              dataType: 'json',
            success: function (data) {
               responce =  data;
            }
        })
     return responce;
    }
</script>